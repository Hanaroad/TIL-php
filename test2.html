<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>회원 등록하기</title>
  </head>
  <body>
    <form id="frm">
      <input type="text" name="uid" id="uid" placeholder="uid" />
      <br />
      이름: <input type="text" name="name" id="name" />
      <br />
      ID:
      <input type="text" name="id" id="id" />
      <br />
      PASSWORD:
      <input type="password" name="password" id="password" autocomplete="off" />
      <br />
      <input type="submit" id="btnRegist" value="회원등록" />
    </form>
    <div>
      <table id="tb">
        <thead>
          <tr>
            <th>순서</th>
            <th>이름</th>
            <th>아이디</th>
            <th>비밀번호</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </body>
</html>

<script>
  //*************************************************
  // declare
  //*************************************************
  const frm = document.getElementById('frm');
  const uid = document.getElementById('uid');
  const name = document.getElementById('name');
  const id = document.getElementById('id');
  const password = document.getElementById('password');
  const btnRegist = document.getElementById('btnRegist');

  //*************************************************
  // DOMContentLoaded
  //*************************************************
  window.addEventListener('DOMContentLoaded', () => {
    btnRegist.addEventListener('click', (e) => {
      e.preventDefault();
      // console.log('aaa');

      if (name.value == '') {
        alert('이름을 입력하세요');
        return false;
      }
      if (id.value == '') {
        alert('아이디를 입력하세요');
        return false;
      }
      if (password.value == '') {
        alert('비밀번호를 입력하세요');
        return false;
      }

      //*************************************************
      // Validate form data
      //*************************************************

      //*************************************************
      // Send form data to server
      //*************************************************

      if (validateFormData(payload)) {
        fetch('regist.php', {
          method: 'POST',
          body: payload,
        })
          .then((res) => {
            if (!res.ok) {
              throw new Error('네트워크 통신이 원활하지 않습니다!');
            }
            return res.text();
          })
          .then((data) => {
            if (data) {
              throw new Error(data);
            } else {
              getMemberList();
            }
          })
          .catch((error) => {
            alert(error);
          });
      }
    });

    function validateFormData(formData) {
      console.log(formdata);
    }
  });
</script>
